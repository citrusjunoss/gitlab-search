(self.webpackChunk=self.webpackChunk||[]).push([[677],{20953:function(Oe,V,n){"use strict";n.r(V),n.d(V,{default:function(){return Se}});var te=n(15558),ne=n.n(te),re=n(90228),T=n.n(re),ae=n(87999),H=n.n(ae),le=n(48305),E=n.n(le),se=n(48980),u=n(73737),B=n(60686),d=n(27947),S=n(74468),J=n(94231),oe=n(42150),m=n(74563),h=n(75271),e=n(52676),ue=function(r){var C=r.allGroups,i=r.keyword,x=r.branch,v=r.selectGroups,f=r.selectGroups1,A=r.isExact,I=r.searchHandle,P=r.updateState,b=u.Z.useForm(),L=E()(b,1),D=L[0];(0,h.useEffect)(function(){D.setFieldsValue({keyword:i,branch:x,selectGroups:v,selectGroups1:f})},[i,x,v,f]);var g=function(p){I(p)},y=function(){D.resetFields(),P({keyword:"",branch:"",selectGroups:[],selectGroups1:"",includePattern:"",excludePattern:""})},j=function(p){P(p)},M=function(p){P({isExact:p})};return(0,e.jsxs)(u.Z,{colon:!1,name:"searchOptions",onFinish:g,onValuesChange:j,form:D,labelAlign:"left",children:[(0,e.jsxs)(B.Z,{gutter:24,children:[(0,e.jsx)(d.Z,{span:8,children:(0,e.jsx)(u.Z.Item,{label:"\u5173\u952E\u5B57",name:"keyword",rules:[{required:!0}],children:(0,e.jsx)(S.Z,{placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u5173\u952E\u5B57",allowClear:!0})})}),(0,e.jsx)(d.Z,{span:8,children:A?(0,e.jsx)(u.Z.Item,{label:"\u7FA4\u7EC4",name:"selectGroups",children:(0,e.jsx)(J.Z,{showSearch:!0,mode:"multiple",allowClear:!0,placeholder:"\u8BF7\u9009\u62E9\u7CFB\u7EDFgroup\uFF0C\u4E0D\u9009\u9ED8\u8BA4\u5168\u5C40",filterOption:function(p,Z){return(Z==null?void 0:Z.children).toLowerCase().indexOf(p.toLowerCase())>=0},children:C.length&&C.map(function(c){return(0,e.jsx)(J.Z.Option,{value:c.id,children:c.full_path},c.id)})})}):(0,e.jsx)(u.Z.Item,{label:"\u7FA4\u7EC4",name:"selectGroups1",children:(0,e.jsx)(S.Z,{placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u5173\u952E\u5B57",allowClear:!0})})}),(0,e.jsx)(d.Z,{span:8,children:(0,e.jsx)(u.Z.Item,{label:"\u5206\u652F/\u6807\u7B7E",name:"branch",children:(0,e.jsx)(S.Z,{placeholder:"\u9ED8\u8BA4\u4E3A\u9879\u76EE\u7684\u9ED8\u8BA4\u5206\u652F",allowClear:!0})})})]}),(0,e.jsx)(B.Z,{gutter:24,children:(0,e.jsxs)(d.Z,{span:24,children:[(0,e.jsx)(oe.Z,{checkedChildren:"\u7CBE\u786E\u7FA4\u7EC4",unCheckedChildren:"\u6A21\u7CCA\u7FA4\u7EC4",style:{marginRight:20},checked:A,onChange:M}),(0,e.jsx)(m.ZP,{type:"primary",htmlType:"submit",style:{marginRight:20},icon:(0,e.jsx)(se.Z,{}),children:"\u641C\u7D22"}),(0,e.jsx)(m.ZP,{htmlType:"button",onClick:y,children:"\u91CD\u7F6E"})]})})]})},ie=ue,k=n(64221),ce=function(r){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"gitlab-search-stats",i=r.map(function(f){return{\u5E8F\u53F7:f.index,\u9879\u76EE\u540D\u79F0:f.projectName,\u9879\u76EE\u94FE\u63A5:f.projectLink,\u6587\u4EF6\u5217\u8868:f.files.join(`
`)}}),x=k.P6.json_to_sheet(i);x["!cols"]=[{wch:5},{wch:40},{wch:50},{wch:80}];var v=k.P6.book_new();k.P6.book_append_sheet(v,x,"Search Stats"),k.NC(v,"".concat(C,".xlsx"))},de=n(3669),he=n(11768),fe=n(11069),pe=n(86422),me=n(92983),w=n(60844),xe=n(50909),K=n(57791),ve=n(81465),je=n(57224),Ce=n(3215),ge=n(35034),ye=n(33485),Ze=n(63793),Q=n.n(Ze),Fe=w.Z.Title,G=w.Z.Text,U=w.Z.Link,Ee=function(){var r=(0,me.useModel)("gitlabModel"),C=r.keyword,i=r.token,x=r.branch,v=r.selectGroups,f=r.selectGroups1,A=r.allGroups,I=r.projectTotal,P=r.projectSearched,b=r.codeResult,L=r.status,D=r.loading,g=r.includePattern,y=r.excludePattern,j=r.updateState,M=r.fetchAllGroups,c=r.search,p=r.init,Z=r.isExact,Ge=Z===void 0?!1:Z,Ae=(0,h.useState)(1),X=E()(Ae,2),N=X[0],O=X[1],Pe=(0,h.useState)(10),Y=E()(Pe,2),R=Y[0],be=Y[1],De=(0,h.useState)(!1),q=E()(De,2),Te=q[0],z=q[1],Be=u.Z.useForm(),ke=E()(Be,1),_=ke[0];(0,h.useEffect)(function(){var t=localStorage.getItem("gitlab_token")||"";t&&j({token:t})},[]),(0,h.useEffect)(function(){i&&(0,de.vy)(i)},[i]),(0,h.useEffect)(function(){var t=function(){var a=H()(T()().mark(function l(){return T()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(i&&A.length===0)){s.next=3;break}return s.next=3,M();case 3:case"end":return s.stop()}},l)}));return function(){return a.apply(this,arguments)}}();t()},[i]);var Re=function(){var t=H()(T()().mark(function a(l){return T()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return O(1),s.next=3,j(l);case 3:setTimeout(c,0);case 4:case"end":return s.stop()}},a)}));return function(l){return t.apply(this,arguments)}}(),we=function(a,l){O(a),be(l)},F=(0,h.useMemo)(function(){var t=b;try{if(g){var a=g.split(",").map(function(o){return o.trim()});t=t.filter(function(o){return Q().isMatch(o.file_path,a)})}if(y){var l=y.split(",").map(function(o){return o.trim()});t=t.filter(function(o){var s=!Q().isMatch(o.file_path,l);return s})}}catch(o){console.error("Error applying glob filter:",o),j({status:"\u641C\u7D22\u5F02\u5E38"})}return t},[b,g,y]),ee=(0,h.useMemo)(function(){var t=new Map;return F.forEach(function(a){var l=a.project;t.has(l.id)||t.set(l.id,{index:t.size+1,projectName:l.name_with_namespace,projectLink:l.web_url,files:[]}),t.get(l.id).files.push(a.file_path)}),Array.from(t.values())},[F]),$=F.slice((N-1)*R,N*R),Ie=function(a){O(1),j(a)},Le=function(){_.resetFields()},Me=function(){z(!0)},Ne=[{title:"\u5E8F\u53F7",dataIndex:"index",key:"index",width:60},{title:"\u9879\u76EE\u540D\u79F0",dataIndex:"projectName",key:"projectName"},{title:"\u9879\u76EE\u94FE\u63A5",dataIndex:"projectLink",key:"projectLink",render:function(a){return(0,e.jsx)(U,{href:a,target:"_blank",children:a})}},{title:"\u6587\u4EF6\u5217\u8868",dataIndex:"files",key:"files",render:function(a){return(0,e.jsx)("ul",{style:{paddingLeft:"15px",margin:0},children:a.map(function(l,o){return(0,e.jsx)("li",{children:l},o)})})}}];return(0,e.jsxs)(xe.Z,{className:"layout",children:[(0,e.jsxs)(K.Z,{spinning:!p,children:[(0,e.jsx)(ie,{allGroups:A,keyword:C,branch:x,selectGroups:v,isExact:Ge,selectGroups1:f,includePattern:g,excludePattern:y,searchHandle:Re,updateState:j}),(0,e.jsx)(ve.Z,{style:{borderColor:"#7cb305"},children:"\u641C\u7D22\u7ED3\u679C"}),(0,e.jsxs)(K.Z,{spinning:D,children:[(0,e.jsxs)(Fe,{level:4,children:[(0,e.jsx)(G,{type:"secondary",children:L})," ",(0,e.jsx)(G,{children:" \u5339\u914D\u9879\u76EE\u8FDB\u5EA6\uFF1A"}),(0,e.jsxs)(G,{type:"secondary",children:[P,"/",I]})," ",(0,e.jsx)(G,{children:" \u641C\u7D22\u7ED3\u679C\uFF1A"}),(0,e.jsxs)(G,{type:"secondary",children:[F.length,"/ ",b.length]})]}),(0,e.jsx)(u.Z,{colon:!1,name:"filterOptions",onFinish:Ie,form:_,labelAlign:"left",children:(0,e.jsxs)(B.Z,{gutter:24,children:[(0,e.jsx)(d.Z,{span:8,children:(0,e.jsx)(u.Z.Item,{labelCol:{span:8},wrapperCol:{span:16},name:"includePattern",label:"\u5305\u542B\u6587\u4EF6 (Glob)",tooltip:{title:"e.g., src/**/*.js"},children:(0,e.jsx)(S.Z,{placeholder:"e.g., src/**/*.js",allowClear:!0})})}),(0,e.jsx)(d.Z,{span:8,children:(0,e.jsx)(u.Z.Item,{labelCol:{span:8},wrapperCol:{span:16},name:"excludePattern",label:"\u6392\u9664\u6587\u4EF6 (Glob)",tooltip:{title:"e.g., **/{node_modules,dist}/**"},children:(0,e.jsx)(S.Z,{placeholder:"e.g., **/{node_modules,dist}/**",allowClear:!0})})}),(0,e.jsx)(d.Z,{span:8,children:(0,e.jsxs)(u.Z.Item,{labelCol:{span:0},wrapperCol:{span:24},children:[(0,e.jsx)(m.ZP,{type:"primary",htmlType:"submit",style:{marginRight:20},icon:(0,e.jsx)(he.Z,{}),children:"\u8FC7\u6EE4"}),(0,e.jsx)(m.ZP,{htmlType:"button",onClick:Le,style:{marginRight:20},children:"\u91CD\u7F6E"}),(0,e.jsx)(m.ZP,{htmlType:"button",onClick:Me,icon:(0,e.jsx)(fe.Z,{}),children:"\u7EDF\u8BA1"})]})})]})}),$==null?void 0:$.map(function(t,a){var l="".concat(t.project.web_url,"/-/blob/").concat(t.ref,"/").concat(t.path,"#L").concat(t.startline);return(0,e.jsx)(je.Z,{type:"inner",title:t.file_path,className:"content-code",children:(0,e.jsxs)(B.Z,{wrap:!1,children:[(0,e.jsx)(d.Z,{flex:"40px",className:"content-code__line-number-border",children:ne()(Array(t.codeLines)).map(function(o,s){return(0,e.jsx)("div",{className:"content-code__line-number-border__number",children:"".concat(s+t.startline)},s)})}),(0,e.jsx)(d.Z,{flex:"auto",className:"content-code__line-number-border__code",children:(0,e.jsx)(U,{href:l,target:"_blank",rel:"noopener noreferrer",children:(0,e.jsx)("pre",{children:t.data})})})]})},"".concat(t.file_path,"-").concat(a))}),F.length>R&&(0,e.jsx)(Ce.Z,{showQuickJumper:!0,showSizeChanger:!0,current:N,total:F.length,pageSize:R,onChange:we})]})]}),(0,e.jsx)(ge.Z,{title:"\u641C\u7D22\u7ED3\u679C\u7EDF\u8BA1",open:Te,onCancel:function(){return z(!1)},footer:[(0,e.jsx)(m.ZP,{onClick:function(){return z(!1)},children:"\u5173\u95ED"},"back"),(0,e.jsx)(m.ZP,{type:"primary",icon:(0,e.jsx)(pe.Z,{}),onClick:function(){return ce(ee)},children:"\u5BFC\u51FA Excel"},"export")],width:"80%",children:(0,e.jsx)(ye.Z,{columns:Ne,dataSource:ee,rowKey:"index",pagination:!1,scroll:{y:500}})})]})},Se=Ee},24863:function(){}}]);
